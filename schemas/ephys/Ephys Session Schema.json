{
	"type": "object",
	"properties": {
	"institution": {
      	"type": "string",
        "enum": ["AIND", "MSP"],
		"title": "Institution"
    	},
	"experimenter_full_name": {
			"type": "string",
			"title": "Experimenter full name",
			"description": "First and last name of the experimenter."
		},
	"session_start_time": {
		"type": "string", 
		"format": "date-time",
		"title": "Session start time"
		},
	"session_end_time": {
		"type": "string", 
		"format": "date-time",
		"title": "Session end time"
		},	
	"specimen_id": {
		"type": "integer",
		"title": "Specimen ID"
		},
	"project_name": {
		"type": "string",
		"title": "Project name"
	},
	"project_id": {
		"type": "string",
		"title": "Project ID"
		},
	"session_type": {
		"type": "string", 
		"enum": ["Test", "Foraging A", "Spontaneous", "Foraging B"],
		"title": "Session type"
		},
	"stimulus_protocol_id": {
		"type": "string",
		"title": "Stimulus protocol ID"
		},
	"rig_id": {
		"type": "string",
		"title": "Rig ID",
		},
	"probes": {
		"type": "array",
		"items": { "$ref": "#/$defs/probe" },
		"uniqueItems": true,
		"title": "Probes"
		},
	"lasers": {
		"type": "array",
		"items": {"$ref": "#/$defs/laser"},
		"uniqueItems": true,
		"title": "Lasers"
		}
	},
	"$defs": {
		"probe": {
			"type": "object",
			"properties": {
				"name": {
					"type": "string",
					"title": "Name"
					},
				"tip_targeted_structure": {
					"type": "string"
					},
                "other_targeted_structures": {
                    "type": "string"
                },
                "targeted_ccf_coordinates": {
                    "type": "array",
                    "items": {"$ref": "#/$defs/ccf_coords"},
                    "uniqueItems": true,
                    "minItems": 3,
                    "maxItems": 3,
                    "title": "Targeted CCF coordinates"
                },
                "targeted_lab_coordinates": {
                    "type": "array",
                    "items": {"$ref": "#/$defs/lab_coords"},
                    "uniqueItems": true,
                    "minItems": 3,
                    "maxItems": 3,
                    "title": "Targeted lab coordinates",
                    "description": "Targeted coordinates relative to the headframe"
                },
                "manipulator_coordinates": {
                    "type": "array",
                    "items": {"$ref": "#/$defs/manipulator_coords"},
                    "uniqueItems": true,
                    "minItems": 3,
                    "maxItems": 3,
                    "title": "Manipulator coordinates"
                },
                "manipulator_angles": {
                    "type": "array",
                    "items": {"$ref": "#/$defs/manipulator_angles"},
                    "uniqueItems": true,
                    "title": "Manipulator angles"
                }
            },
            "$defs": {
                "ccf_coords": {
                    "type": "object",
                    "properties": {
                        "direction": {
                            "type": "string",
                            "enum": ["ML", "AP", "DV"],
                            "title": "Direction"
                        },
                        "value": {
                            "type": "number",
                            "title": "Value"
                        }
                    },
                    "required": ["direction", "value"]
                },
                "lab_coords": {
                    "type": "object",
                    "properties": {
                        "direction": {
                            "type": "string",
                            "enum": ["X", "Y", "Z"],
                            "title": "Direction"
                        },
                        "value": {
                            "type": "number",
                            "title": "Value (mm)",
                            "units": "mm",
                        }
                    },
                    "required": ["direction", "value"]
                },
                "manipulator_coords": {
                    "type": "object",
                    "properties": {
                        "direction": {
                            "type": "string",
                            "enum": ["X", "Y", "Z"],
                            "title": "Direction"
                        },
                        "value": {
                            "type": "number",
                            "title": "Value (mm)",
                            "units": "mm"
                        }
                    },
                    "required": ["direction", "value"]
                },
                "manipulator_angles": {
                    "type": "object",
                    "properties": {
                        "name": {
                            "type": "string",
                            "enum": ["XY", "XZ", "YZ"],
                            "title": "Name",
                        },
                        "value": {
                            "type": "number",
                            "units": "deg",
                            "title": "Value (deg)"
                        }
                    },
                    "required": ["name", "value"]
                }
            },
			"required": [
					"name",
					"tip_targeted_structure",
                    "targeted_ccf_coordinates",
                    "targeted_lab_coordinates",
                    "manipulator_coordinates",
                    "manipulator_angles"
					]
		},
		"laser": {
			"type": "object",
			"properties": {
				"name": {
					"type": "string",
                    "title": "Name"
					},
				"wavelength": {
					"type": "integer",
                    "title": "Wavelength (nm)",
                    "units": "nm"
				},

				"Targeted Structure": {
					"type": "string"
					},
				"CCF coordinate ML": {
					"type": "number"
					},
				"CCF coordinate AP": {
					"type": "number"
					},
				"CCF coordinate DV": {
					"type": "number"
					},
				"MRI coordinate ML": {
					"type": "number"
					},
				"MRI coordinate AP": {
					"type": "number"
					},
				"MRI coordinate DV": {
					"type": "number"
					},
				"Coordinate ML": {
					"type": "number"
					},
				"Coordinate AP": {
					"type": "number"
					},
				"Coordinate depth": {
					"type": "number"
					},
				"Angle ML": {
					"type": "number"
					},
				"Angle AP": {
					"type": "number"
					}
				},
			"required": [
					"Name",
					"Wavelength (nm)",
					"Power",
					"Targeted Structure",
					"CCF coordinate ML",
					"CCF coordinate AP",
					"CCF coordinate DV",
					"MRI coordinate ML",
					"MRI coordinate AP",
					"MRI coordinate DV",
					"Coordinate ML",
					"Coordinate AP",
					"Coordinate depth",
					"Angle ML",
					"Angle AP"
					]
		}

	},	
	"required": [
		"Institution",
		"Experimenter first name", 
		"Experimenter last name",
		"Session start time",
		"Specimen ID",
		"Project ID",
		"Session Type",
		"Rig ID",
		"Session end time",
		"Probes"
	]
}
